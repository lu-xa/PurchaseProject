<html xmlns:th="http://www.thymeleaf.org"><HEAD><script src="/jquery-easyui-1.6.3/jquery.min.js" charset="utf-8"></script><!-- easyui依赖的js --><script src="/jquery-easyui-1.6.3/jquery.easyui.min.js" charset="utf-8"></script><!--引用对应的语言包 --><script src="/jquery-easyui-1.6.3/locale/easyui-lang-zh_CN.js" charset="utf-8"></script><!-- 引用图标样式 --><link rel="stylesheet" href="/jquery-easyui-1.6.3/themes/icon.css"><!-- 引用默认的样式 --><link rel="stylesheet" href="/jquery-easyui-1.6.3/themes/default/easyui.css"><TITLE>需求一览表</TITLE><SCRIPT language=JAVASCRIPT> </SCRIPT><META http-equiv=Content-Language content=zh-cn><META http-equiv=Content-Type content="text/html; charset=gb2312"><META content="MSHTML 6.00.2900.5626" name=GENERATOR><META content=FrontPage.Editor.Document name=ProgId><LINK href="css/style.css" rel=stylesheet><SCRIPT language=JavaScript src="css/pub_Calendar.js"></SCRIPT><SCRIPT language=javascript>      function submit_form(theForm,i)      {	          var count=0;        for (var k = 0; k < theForm.length; k++)        if ((theForm[k].type == "radio") && (theForm[k].checked))        count++;        if (count==0)        {          alert("提示信息：\n请选择需求计划。");          return;        }        document.form.p_type.value=i;        window.document.form.submit();        return true;      }      function submit_form_cx()      {        form.action="Order_ytb_list.asp";        window.document.form.submit();      }	   function workLog01()  	 {  		window.open("work_log01.htm","Canny1","toolbar=0,location=0,status=0,menubar=0,scrollbars=0,width=600,height=440,left=100,top=60");       	 }	 		 	 function update_xuqiujihua(){//修改		 	var obj = document.getElementsByName("checkbox");		var len = obj.length;		var count=0;		var no=0;		for(var i=0;i<len;i++){			if(obj[i].checked){				count++;				var objTable = document.getElementById("table1");				var oldTr=objTable.rows[i+1];				if(obj[i].parentNode.parentNode.parentNode.lastElementChild.innerText=="确定"){					alert("已确定的需求计划不能修改！");					no=1;					break;				}			}		}		if(count==0){			alert("至少选择一条数据修改！");		}else if(count>1){			alert("一次只能修改一条数据！");		}else if(no==0){			for(var i = 0;i<len;i++){				if(obj[i].checked){					//console.log("id=" + obj[i].id);					window.open("/toUpdateOrder?id="+obj[i].id,"Canny2","toolbar=0,location=0,status=0,menubar=0,scrollbars=0,width=600,height=440,left=100,top=60");				}							}					}			 }	 	  function quedingData(){//确定		 // console.log(1);	 	var obj = document.getElementsByName("checkbox");		var len = obj.length;	 	var count=0;		var no=0;		 for(var i=0;i<len;i++){			if(obj[i].checked){				count++;								var tdStr = document.getElementById("td_"+obj[i].id).innerHTML;				//console.log("td:" +tdStr);				//console.log("obj[i]="+obj[i].parentNode.parentNode.parentNode.lastElementChild.innerText);				if(tdStr=="确定"){					alert("选定的数据中有数已确定，请重新选择。");					obj[i].checked="";					no=1;					break;				}			}		} 		if(count==0){			alert("至少选择一条数据！");		}else if(no!=1){						for(var i=0;i<len;i++){			if(obj[i].checked){								var objTable = document.getElementById("table1");				var oldTr=objTable.rows[i+1];				var id= obj[i].id;				//console.log("id="+id);				$.ajax({					method:'post',					url:'/ensureOrder',					data:"id="+id,					success:function(data){						//obj[i].parentNode.parentNode.parentNode.lastElementChild.innerText="确定";						alert("已确定");						//console.log("成功。。" );						//console.log(obj[i].parentNode.parentNode.lastElementChild.innerText);												window.location.reload(); 					},					error:function(XMLHttpRequest, textStatus, errorThrown){						console.log(errorThrown)						alert('jQuery ajax出错了~');					}								});											}		}		}			}	 	 function getLen(){		 obj01=document.getElementById("table1");	 	cGetRow=window.event.srcElement.parentElement.parentElement.rowIndex;	 }	 	 	 function delData(){//删除		 if(confirm("确定删除这条数据吗？")){			 var obj = document.getElementsByName("checkbox");			 for (var i=0;i< obj.length;i++){				 if(obj[i].checked){					 $.ajax({						 method:'post',						 url:'/deleteOrderById',						 data:"id="+ obj[i].id,						 success:function(){							 alert("删除成功！");							 window.location.reload(); 							//var tr = obj[i].parentNode;						 },						 error:function(){							 alert("删除出错了");						 }					 });				 }		 }		 	}		 	 	/* var obj = document.getElementById("p_orderno");	 	if(obj.checked){			obj01.deleteRow(cGetRow);		}else{			alert("请选择要删除的数据！");		} */	 }		 /* function opp(obj){	  var c=document.getElementById("xiugai");	   var d=document.getElementById("shanchu");	  c.disabled=obj;	   d.disabled=obj;	 	 } */	 	 	 	  function ddtzDdmx() //详情 	 {	 	var obj = document.getElementsByName("checkbox");		var len = obj.length;	 	var count=0;		for(var i=0;i<len;i++){			if(obj[i].checked){				count++;			}		}		if(count==0){			alert("至少选择一条数据！");		}else if(count>1){			alert("一次只能查看一条数据！");		}else{						for(var i=0;i<len;i++){				if(obj[i].checked){					window.open("/findOrderDetail?id="+obj[i].id,"Canny2","toolbar=0,location=0,status=0,menubar=0,scrollbars=0,width=600,height=440,left=100,top=60");				}			}		}  		       	 }</SCRIPT></HEAD><BODY><CENTER><FORM name=form action=Order_ytb_do.asp method=post><INPUT type=hidden value=3 name=p_type> <H2><FONT color=#0070c0>需求计划一览表</FONT></H2><TABLE cellSpacing=1 cellPadding=0 width="100%" bgColor=#ffffff borderColorLight=#ffffff border=0>  <TBODY>  <TR>    <TD>      <TABLE cellSpacing=1 cellPadding=3 width="100%" border=0>        <TBODY>        <TR>          <TD noWrap align=middle>物资编码：<INPUT size=10             name=p_prodno>&nbsp;&nbsp; 物资名称：<INPUT size=10             name=p_prodname>&nbsp;&nbsp; 状态：            <SELECT style="WIDTH: 115px"             name=p_status>              <OPTION value="" selected>全部</OPTION>              <OPTION               value=70>未确定</OPTION>              <OPTION               value=70>确定</OPTION>            </SELECT> <INPUT onclick=submit_form_cx() type=button value=查询></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><FORM name="form1" action="" method="Post"><CENTER><FONT color=#000064>◆&nbsp;</FONT><FONT color=#000064>首页 上一页</FONT>&nbsp;<A href="http://169.254.158.100/zzdl/Order/Order_ytb_list.asp?p_type=3&amp;p_prodno=&amp;p_prodname=&amp;p_status=&amp;p_stocktype=&amp;p_ordertype=&amp;page=2"><FONT color=#0000be>下一页</FONT></A>&nbsp;<A href="http://169.254.158.100/zzdl/Order/Order_ytb_list.asp?p_type=3&amp;p_prodno=&amp;p_prodname=&amp;p_status=&amp;p_stocktype=&amp;p_ordertype=&amp;page=22"><FONT color=#0000be>尾页</FONT></A><FONT color=#000064>&nbsp;共 214 个需求计划 每页10 个需求计划</FONT><FONT color=#000064>&nbsp;页次:<FONT color=blue>1</FONT>/22页</FONT><FONT color=#000064>&nbsp;◆&nbsp;</FONT> <TABLE style="LINE-HEIGHT: 30px" cellSpacing=1 cellPadding=0 width="100%" bgColor=#336699 borderColorLight=#006699 border=0>  <TBODY>  <TR>    <TD>      <TABLE cellSpacing=1 cellPadding=3 width="100%" border=0 id="table1">        <TBODY>        <TR class=t1>          <TD noWrap align=middle>选择</TD>          <TD noWrap align=middle>序号</TD>          <TD noWrap align=middle>物资代码</TD>          <TD noWrap align=middle>物资名称</TD>          <TD noWrap align=middle>数量</TD>          <TD noWrap align=middle>采购进度</TD>          </TR>        <TR class=t2 th:each="order :${ordersList}">          <TD align=middle><label>            <input type="checkbox" name="checkbox" th:id="${order.id}" value="checkbox" onClick="opp(true)">            </label></TD>          <TD th:text ="${order.id}">1</TD>          <TD th:text ="${order.materialCode}">W64001005001<BR></TD>          <TD th:text ="${order.materialName}">晶振(HC-49U-500M-0.005%)<BR></TD>          <TD th:text ="${order.amount}" align=right>222<BR></TD>                   <TD th:id="'td_'+${order.id}" th:text ="${order.iMapping.status} eq'C001-10'?'未确认' : '确定' ">未确认<BR></TD>          </TR>        <!-- <TR class=t2>          <TD align=middle><label>            <input type="checkbox" name="checkbox" value="checkbox" onClick="opp(false)">          </label></TD>          <TD>2</TD>          <TD>W65000400101<BR></TD>          <TD>CMOS电路(CD4001BCN)<BR></TD>          <TD align=right>12<BR></TD>          <TD>制造中心采购</TD>          <TD>确定<BR></TD>          </TR>        <TR class=t2>          <TD align=middle><input type="checkbox" name="checkbox" value="checkbox" onClick="opp(true)"></TD>          <TD>3</TD>          <TD>W64001005000<BR></TD>          <TD>晶振(HC-49U-500K-0.005%)<BR></TD>          <TD align=right>222<BR></TD>          <TD>制造中心采购</TD>          <TD>未确认<BR></TD>          </TR>        <TR class=t2>          <TD align=middle><input type="checkbox" name="checkbox" value="checkbox" onClick="opp(true)"></TD>          <TD>4</TD>          <TD>WW0000000005<BR></TD>          <TD>网络配件<BR></TD>          <TD align=right>44444444444<BR></TD>          <TD>制造中心采购公开求购</TD>          <TD>未确认<BR></TD>          </TR> -->        </TBODY></TABLE></TD></TR></TBODY></TABLE><INPUT type=hidden value=3 name=p_listtype> <INPUT type=hidden value=1 name=page> </FORM><P align=center><INPUT name="button" type=button onclick=select_check(document.form) value=全选/取消><INPUT onClick="quedingData()" type=button value=确定><INPUT onClick="javascript:ddtzDdmx()" type=button value=详情> <INPUT onClick="update_xuqiujihua();" type=button value=修改 name='xiugai'> <INPUT onClick="delData();" type=button value=删除 name='shanchu'></P>            </CENTER></CENTER></BODY></html>